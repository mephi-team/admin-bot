<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Рассылки — Админка Flexiq</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .broadcast-card { border-left: 4px solid #6f42c1; }
    </style>
</head>
<body class="bg-light">
<div class="container py-4">
    <h1 class="mb-4">Рассылки</h1>

    <!-- Форма создания рассылки -->
    <div class="card mb-4">
        <div class="card-header bg-purple text-white" style="background-color: #6f42c1 !important;">
            Создать новую рассылку
        </div>
        <div class="card-body">
            <form method="post" th:action="@{/broadcasts}" th:object="${newBroadcast}">
                <div class="mb-3">
                    <label class="form-label" for="messageText">Текст рассылки</label>
                    <textarea class="form-control" id="messageText"
                              placeholder="Введите текст, который получат все пользователи..." required rows="4"
                              th:field="*{messageText}"></textarea>
                </div>
                <button class="btn btn-primary" type="submit">Сохранить рассылку</button>
                <div class="mt-2 text-muted small">
                    <em>Рассылка будет отправлена чат-ботом позже. Здесь вы только формируете сообщение.</em>
                </div>
            </form>
        </div>
    </div>

    <!-- История рассылок -->
    <div class="card">
        <div class="card-header bg-secondary text-white">
            История рассылок
        </div>
        <div class="card-body">
            <div class="text-muted" th:if="${broadcasts.empty}">
                Нет сохранённых рассылок.
            </div>

            <div class="broadcast-card p-3 mb-3 border" th:each="b : ${broadcasts}">
                <div class="d-flex justify-content-between align-items-start">
                    <div>
                        <div class="fw-bold mb-1">Рассылка №<span th:text="${b.id}">1</span></div>
                        <div class="text-break" th:text="${b.messageText}">Текст рассылки...</div>
                    </div>
                    <small class="text-muted" th:text="${#temporals.format(b.createdAt, 'dd.MM.yyyy HH:mm')}">08.12.2025
                        14:30</small>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>